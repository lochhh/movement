
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/smooth.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_smooth.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_smooth.py:

Smooth pose tracks
=====================

Smooth pose tracks using the median and Savitzky-Golay filters.

.. GENERATED FROM PYTHON SOURCE LINES 8-10

Imports
-------

.. GENERATED FROM PYTHON SOURCE LINES 10-21

.. code-block:: Python


    from matplotlib import pyplot as plt
    from scipy.signal import welch

    from movement import sample_data
    from movement.filtering import (
        interpolate_over_time,
        median_filter,
        savgol_filter,
    )








.. GENERATED FROM PYTHON SOURCE LINES 22-28

Load a sample dataset
---------------------
Let's load a sample dataset and print it to inspect its contents.
Note that if you are running this notebook interactively, you can simply
type the variable name (here ``ds_wasp``) in a cell to get an interactive
display of the dataset's contents.

.. GENERATED FROM PYTHON SOURCE LINES 28-32

.. code-block:: Python


    ds_wasp = sample_data.fetch_dataset("DLC_single-wasp.predictions.h5")
    print(ds_wasp)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.Dataset> Size: 61kB
    Dimensions:      (time: 1085, individuals: 1, keypoints: 2, space: 2)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * individuals  (individuals) <U12 48B 'individual_0'
      * keypoints    (keypoints) <U7 56B 'head' 'stinger'
      * space        (space) <U1 8B 'x' 'y'
    Data variables:
        position     (time, individuals, keypoints, space) float64 35kB 1.086e+03...
        confidence   (time, individuals, keypoints) float64 17kB 0.05305 ... 0.0
    Attributes:
        fps:              40.0
        time_unit:        seconds
        source_software:  DeepLabCut
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...
        video_path:       None




.. GENERATED FROM PYTHON SOURCE LINES 33-37

We see that the dataset contains the 2D pose tracks and confidence scores
for a single wasp, generated with DeepLabCut. The wasp is tracked at two
keypoints: "head" and "stinger" in a video that was recorded at 40 fps and
lasts for approximately 27 seconds.

.. GENERATED FROM PYTHON SOURCE LINES 39-47

Define a plotting function
--------------------------
Let's define a plotting function to help us visualise the effects of
smoothing both in the time and frequency domains.
The function takes as inputs two datasets containing raw and smooth data
respectively, and plots the position time series and power spectral density
(PSD) for a given individual and keypoint. The function also allows you to
specify the spatial coordinate (``x`` or ``y``) and a time range to focus on.

.. GENERATED FROM PYTHON SOURCE LINES 47-112

.. code-block:: Python



    def plot_raw_and_smooth_timeseries_and_psd(
        ds_raw,
        ds_smooth,
        individual="individual_0",
        keypoint="stinger",
        space="x",
        time_range=None,
    ):
        # If no time range is specified, plot the entire time series
        if time_range is None:
            time_range = slice(0, ds_raw.time[-1])

        selection = {
            "time": time_range,
            "individuals": individual,
            "keypoints": keypoint,
            "space": space,
        }

        fig, ax = plt.subplots(2, 1, figsize=(10, 6))

        for ds, color, label in zip(
            [ds_raw, ds_smooth], ["k", "r"], ["raw", "smooth"], strict=False
        ):
            # plot position time series
            pos = ds.position.sel(**selection)
            ax[0].plot(
                pos.time,
                pos,
                color=color,
                lw=2,
                alpha=0.7,
                label=f"{label} {space}",
            )

            # interpolate data to remove NaNs in the PSD calculation
            pos_interp = interpolate_over_time(pos, print_report=False)

            # compute and plot the PSD
            freq, psd = welch(pos_interp, fs=ds.fps, nperseg=256)
            ax[1].semilogy(
                freq,
                psd,
                color=color,
                lw=2,
                alpha=0.7,
                label=f"{label} {space}",
            )

        ax[0].set_ylabel(f"{space} position (px)")
        ax[0].set_xlabel("Time (s)")
        ax[0].set_title("Time Domain")
        ax[0].legend()

        ax[1].set_ylabel("PSD (px$^2$/Hz)")
        ax[1].set_xlabel("Frequency (Hz)")
        ax[1].set_title("Frequency Domain")
        ax[1].legend()

        plt.tight_layout()
        fig.show()









.. GENERATED FROM PYTHON SOURCE LINES 113-122

Smoothing with a median filter
------------------------------
Using the :func:`movement.filtering.median_filter` function on the
``position`` data variable, we can apply a rolling window median filter
over a 0.1-second window (4 frames) to the wasp dataset.
As the ``window`` parameter is defined in *number of observations*,
we can simply multiply the desired time window by the frame rate
of the video. We will also create a copy of the dataset to avoid
modifying the original data.

.. GENERATED FROM PYTHON SOURCE LINES 122-127

.. code-block:: Python


    window = int(0.1 * ds_wasp.fps)
    ds_wasp_smooth = ds_wasp.copy()
    ds_wasp_smooth.update({"position": median_filter(ds_wasp.position, window)})





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 61kB
    Dimensions:      (time: 1085, individuals: 1, keypoints: 2, space: 2)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
      * keypoints    (keypoints) &lt;U7 56B &#x27;head&#x27; &#x27;stinger&#x27;
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
    Data variables:
        position     (time, individuals, keypoints, space) float64 35kB 1.086e+03...
        confidence   (time, individuals, keypoints) float64 17kB 0.05305 ... 0.0
    Attributes:
        fps:              40.0
        time_unit:        seconds
        source_software:  DeepLabCut
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...
        video_path:       None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6c956087-5c78-4467-9fc9-1d969bae1368' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6c956087-5c78-4467-9fc9-1d969bae1368' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1085</li><li><span class='xr-has-index'>individuals</span>: 1</li><li><span class='xr-has-index'>keypoints</span>: 2</li><li><span class='xr-has-index'>space</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-998f2836-ce3d-4177-9804-c12ebf178d90' class='xr-section-summary-in' type='checkbox'  checked><label for='section-998f2836-ce3d-4177-9804-c12ebf178d90' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.025 0.05 ... 27.05 27.07 27.1</div><input id='attrs-b4f088ac-8248-47f0-9905-ac422a61bda8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b4f088ac-8248-47f0-9905-ac422a61bda8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbdab4cd-d4a3-4b12-b174-0c675a5274f8' class='xr-var-data-in' type='checkbox'><label for='data-cbdab4cd-d4a3-4b12-b174-0c675a5274f8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.0000e+00, 2.5000e-02, 5.0000e-02, ..., 2.7050e+01, 2.7075e+01,
           2.7100e+01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-91818dba-73ff-4846-8b04-29bf9b2a3c6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-91818dba-73ff-4846-8b04-29bf9b2a3c6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e7c9ccf-e749-485f-91c2-1c5d0c841528' class='xr-var-data-in' type='checkbox'><label for='data-4e7c9ccf-e749-485f-91c2-1c5d0c841528' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;head&#x27; &#x27;stinger&#x27;</div><input id='attrs-3cee2b30-f093-459a-b65e-40cea923e8af' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3cee2b30-f093-459a-b65e-40cea923e8af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9662cf33-ea72-47b6-a7f7-1884ee4c118b' class='xr-var-data-in' type='checkbox'><label for='data-9662cf33-ea72-47b6-a7f7-1884ee4c118b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-59310c4b-8cd9-41c0-8371-174b707fa6b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-59310c4b-8cd9-41c0-8371-174b707fa6b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3ecc3f0-ac94-4779-9df6-4a6413ea04e2' class='xr-var-data-in' type='checkbox'><label for='data-b3ecc3f0-ac94-4779-9df6-4a6413ea04e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5fca8af9-71fb-4437-a3d9-87f4cc82cf07' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5fca8af9-71fb-4437-a3d9-87f4cc82cf07' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, individuals, keypoints, space)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.086e+03 421.5 ... 0.0 0.0</div><input id='attrs-dffe3a55-a684-4785-831f-ea3297cb1f39' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dffe3a55-a684-4785-831f-ea3297cb1f39' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74d82fda-7c31-497b-b563-08b2bd364f23' class='xr-var-data-in' type='checkbox'><label for='data-74d82fda-7c31-497b-b563-08b2bd364f23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;median_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:29.009332&#x27;, &#x27;arg_1&#x27;: 4}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[1086.02038574,  421.54428101],
             [1083.36999512,  421.45770264]]],


           [[[1086.02038574,  421.54428101],
             [1083.36999512,  421.45770264]]],


           [[[1085.78253174,  421.67584229],
             [1083.15985107,  421.53366089]]],


           ...,


           [[[   0.        ,    0.        ],
             [   0.        ,    0.        ]]],


           [[[   0.        ,    0.        ],
             [   0.        ,    0.        ]]],


           [[[   0.        ,    0.        ],
             [   0.        ,    0.        ]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, individuals, keypoints)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.05305 0.07366 0.03532 ... 0.0 0.0</div><input id='attrs-51227a20-cb07-43d8-af88-3328a8c7b136' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-51227a20-cb07-43d8-af88-3328a8c7b136' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15497ba5-d571-4631-8c84-003b70288d86' class='xr-var-data-in' type='checkbox'><label for='data-15497ba5-d571-4631-8c84-003b70288d86' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.05305099, 0.07366323]],

           [[0.03531652, 0.03293059]],

           [[0.01706707, 0.01022208]],

           ...,

           [[0.        , 0.        ]],

           [[0.        , 0.        ]],

           [[0.        , 0.        ]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-52609d6a-4803-4ba2-a7d3-a8690414ddf9' class='xr-section-summary-in' type='checkbox'  ><label for='section-52609d6a-4803-4ba2-a7d3-a8690414ddf9' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-211adf0e-4ae5-4b20-8d6c-ca7eb7a6874e' class='xr-index-data-in' type='checkbox'/><label for='index-211adf0e-4ae5-4b20-8d6c-ca7eb7a6874e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,  0.025,   0.05,  0.075,    0.1,  0.125,   0.15,  0.175,    0.2,
            0.225,
           ...
           26.875,   26.9, 26.925,  26.95, 26.975,   27.0, 27.025,  27.05, 27.075,
             27.1],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=1085))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7022c843-0800-455d-a3b7-d9177a67b4a6' class='xr-index-data-in' type='checkbox'/><label for='index-7022c843-0800-455d-a3b7-d9177a67b4a6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-33ded87d-562b-433e-ba3c-1eccd9b5eb2c' class='xr-index-data-in' type='checkbox'/><label for='index-33ded87d-562b-433e-ba3c-1eccd9b5eb2c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5fc48437-53d7-4ba3-82bf-0338e3ca643e' class='xr-index-data-in' type='checkbox'/><label for='index-5fc48437-53d7-4ba3-82bf-0338e3ca643e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c1bfc332-9522-41f1-8a3d-2de4ca8db0f4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c1bfc332-9522-41f1-8a3d-2de4ca8db0f4' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fps :</span></dt><dd>40.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_software :</span></dt><dd>DeepLabCut</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/DLC_single-wasp.predictions.h5</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-wasp_frame-10sec.png</dd><dt><span>video_path :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 128-131

We see from the printed report that the dataset has no missing values
neither before nor after smoothing. Let's visualise the effects of the
median filter in the time and frequency domains.

.. GENERATED FROM PYTHON SOURCE LINES 131-136

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_wasp, ds_wasp_smooth, keypoint="stinger"
    )




.. image-sg:: /examples/images/sphx_glr_smooth_001.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 137-147

We see that the median filter has removed the "spikes" present around the
14 second mark in the raw data. However, it has not dealt the big shift
occurring during the final second. In the frequency domain, we can see that
the filter has reduced the power in the high-frequency components, without
affecting the low frequency components.

This illustrates what the median filter is good at: removing brief "spikes"
(e.g. a keypoint abruptly jumping to a different location for a frame or two)
and high-frequency "jitter" (often present due to pose estimation
working on a per-frame basis).

.. GENERATED FROM PYTHON SOURCE LINES 149-155

Choosing parameters for the median filter
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
We can control the behaviour of the median filter
via two parameters: ``window`` and ``min_periods``.
To better understand the effect of these parameters, let's use a
dataset that contains missing values.

.. GENERATED FROM PYTHON SOURCE LINES 155-159

.. code-block:: Python


    ds_mouse = sample_data.fetch_dataset("SLEAP_single-mouse_EPM.analysis.h5")
    print(ds_mouse)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    <xarray.Dataset> Size: 1MB
    Dimensions:      (time: 18485, individuals: 1, keypoints: 6, space: 2)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * individuals  (individuals) <U12 48B 'individual_0'
      * keypoints    (keypoints) <U9 216B 'snout' 'left_ear' ... 'tail_end'
      * space        (space) <U1 8B 'x' 'y'
    Data variables:
        position     (time, individuals, keypoints, space) float32 887kB nan ... ...
        confidence   (time, individuals, keypoints) float32 444kB nan nan ... 0.7607
    Attributes:
        fps:              30.0
        time_unit:        seconds
        source_software:  SLEAP
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...
        video_path:       None




.. GENERATED FROM PYTHON SOURCE LINES 160-166

The dataset contains a single mouse with six keypoints tracked in
2D space. The video was recorded at 30 fps and lasts for ~616 seconds. We can
see that there are some missing values, indicated as "nan" in the
printed dataset.
Let's apply the median filter over a 0.1-second window (3 frames)
to the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 166-171

.. code-block:: Python


    window = int(0.1 * ds_mouse.fps)
    ds_mouse_smooth = ds_mouse.copy()
    ds_mouse_smooth.update({"position": median_filter(ds_mouse.position, window)})





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 5106/18485 (27.6%)
                    left_ear: 678/18485 (3.7%)
                    right_ear: 695/18485 (3.8%)
                    centre: 640/18485 (3.5%)
                    tail_base: 913/18485 (4.9%)
                    tail_end: 3103/18485 (16.8%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, individuals: 1, keypoints: 6, space: 2)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
    Data variables:
        position     (time, individuals, keypoints, space) float32 887kB nan ... ...
        confidence   (time, individuals, keypoints) float32 444kB nan nan ... 0.7607
    Attributes:
        fps:              30.0
        time_unit:        seconds
        source_software:  SLEAP
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...
        video_path:       None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-02b42ac4-4da0-4187-adc0-e60a24176e7e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-02b42ac4-4da0-4187-adc0-e60a24176e7e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>individuals</span>: 1</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>space</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-18741795-d3c0-48c6-8318-c6a98136836c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-18741795-d3c0-48c6-8318-c6a98136836c' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-0198476c-828c-4e8e-98aa-ec640eb42c4b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0198476c-828c-4e8e-98aa-ec640eb42c4b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-934d8f56-e656-4594-9c4e-e2d3fc53acdf' class='xr-var-data-in' type='checkbox'><label for='data-934d8f56-e656-4594-9c4e-e2d3fc53acdf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-a6d93c23-abbf-4f27-8228-e6389f279b26' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a6d93c23-abbf-4f27-8228-e6389f279b26' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9a74963-d97b-49ac-b0e4-fdd4c4d3b208' class='xr-var-data-in' type='checkbox'><label for='data-f9a74963-d97b-49ac-b0e4-fdd4c4d3b208' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-336afc25-e55d-4a19-a758-3bc01eb8ad28' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-336afc25-e55d-4a19-a758-3bc01eb8ad28' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7392b2d4-4b3c-45de-be3e-1cbaa883f636' class='xr-var-data-in' type='checkbox'><label for='data-7392b2d4-4b3c-45de-be3e-1cbaa883f636' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-3e014e12-cf54-4a44-bab5-7b3d7b9a3a2b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3e014e12-cf54-4a44-bab5-7b3d7b9a3a2b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec20a5fa-81de-4717-ac0e-5786b4083594' class='xr-var-data-in' type='checkbox'><label for='data-ec20a5fa-81de-4717-ac0e-5786b4083594' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4a379c58-9aff-4154-b640-6e79700488e0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4a379c58-9aff-4154-b640-6e79700488e0' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, individuals, keypoints, space)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 384.0 588.6 476.3</div><input id='attrs-ecee7d98-4d51-4b58-873b-c74cbff36bad' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ecee7d98-4d51-4b58-873b-c74cbff36bad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0fc4525e-628d-47a5-b9ab-9d2d52ced630' class='xr-var-data-in' type='checkbox'><label for='data-0fc4525e-628d-47a5-b9ab-9d2d52ced630' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;median_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:29.289758&#x27;, &#x27;arg_1&#x27;: 3}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
    ...
             [668.40027, 492.0457 ],
             [667.9094 , 437.27432],
             [636.7274 , 384.24048],
             [588.62775, 476.814  ]]],


           [[[688.1045 , 504.95605],
             [692.205  , 484.86316],
             [668.40027, 492.0457 ],
             [667.8683 , 439.9774 ],
             [636.824  , 384.10602],
             [588.56854, 476.33466]]],


           [[[688.18134, 507.72455],
             [692.3218 , 484.5658 ],
             [668.4878 , 492.0457 ],
             [667.9094 , 439.9774 ],
             [636.8362 , 384.02936],
             [588.56854, 476.33466]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, individuals, keypoints)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-2efc5972-4358-4739-9991-76455fab031a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2efc5972-4358-4739-9991-76455fab031a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-93900f3f-73d1-4ba1-a2c3-e1c96c089cf6' class='xr-var-data-in' type='checkbox'><label for='data-93900f3f-73d1-4ba1-a2c3-e1c96c089cf6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           ...,

           [[0.9317396 , 1.0026728 , 1.025079  , 0.92725545, 0.95202184,
             0.7779419 ]],

           [[0.9193515 , 1.0136327 , 1.0336665 , 0.93108493, 0.94561106,
             0.7662804 ]],

           [[0.93820494, 1.0224991 , 1.0452943 , 0.9363993 , 0.9335798 ,
             0.76068705]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4ae8470d-05f7-41fb-a09e-7ab41f3a4451' class='xr-section-summary-in' type='checkbox'  ><label for='section-4ae8470d-05f7-41fb-a09e-7ab41f3a4451' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b76d17f9-c9e1-4fd9-a09c-c923d597b7d7' class='xr-index-data-in' type='checkbox'/><label for='index-b76d17f9-c9e1-4fd9-a09c-c923d597b7d7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-204fba5a-0695-42d5-b41a-55cb6a9f1e39' class='xr-index-data-in' type='checkbox'/><label for='index-204fba5a-0695-42d5-b41a-55cb6a9f1e39' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9a586ee8-52ed-4176-859d-365d3012b36f' class='xr-index-data-in' type='checkbox'/><label for='index-9a586ee8-52ed-4176-859d-365d3012b36f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2a0856dd-aae4-409d-9252-d23469a38fba' class='xr-index-data-in' type='checkbox'/><label for='index-2a0856dd-aae4-409d-9252-d23469a38fba' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5fe128e1-532f-47be-bd87-e1b937bbf727' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5fe128e1-532f-47be-bd87-e1b937bbf727' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd><dt><span>video_path :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 172-183

The report informs us that the raw data contains NaN values, most of which
occur at the ``snout`` and ``tail_end`` keypoints. After filtering, the
number of NaNs has increased. This is because the default behaviour of the
median filter is to propagate NaN values, i.e. if any value in the rolling
window is NaN, the output will also be NaN.

To modify this behaviour, you can set the value of the ``min_periods``
parameter to an integer value. This parameter determines the minimum number
of non-NaN values required in the window for the output to be non-NaN.
For example, setting ``min_periods=2`` means that two non-NaN values in the
window are sufficient for the median to be calculated. Let's try this.

.. GENERATED FROM PYTHON SOURCE LINES 183-188

.. code-block:: Python


    ds_mouse_smooth.update(
        {"position": median_filter(ds_mouse.position, window, min_periods=2)}
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 4455/18485 (24.1%)
                    left_ear: 487/18485 (2.6%)
                    right_ear: 507/18485 (2.7%)
                    centre: 465/18485 (2.5%)
                    tail_base: 673/18485 (3.6%)
                    tail_end: 2428/18485 (13.1%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, individuals: 1, keypoints: 6, space: 2)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
    Data variables:
        position     (time, individuals, keypoints, space) float32 887kB nan ... ...
        confidence   (time, individuals, keypoints) float32 444kB nan nan ... 0.7607
    Attributes:
        fps:              30.0
        time_unit:        seconds
        source_software:  SLEAP
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...
        video_path:       None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e634977e-5ac2-4c9a-9b4b-cf876316382c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e634977e-5ac2-4c9a-9b4b-cf876316382c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>individuals</span>: 1</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>space</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f604455d-8dc8-48cf-8fb3-f04be53af4d0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f604455d-8dc8-48cf-8fb3-f04be53af4d0' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-3a4e9d0e-9cd7-4c51-bd1b-89fa9462fb84' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3a4e9d0e-9cd7-4c51-bd1b-89fa9462fb84' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed66618d-0c3b-4dd0-ab98-8f447da9ff13' class='xr-var-data-in' type='checkbox'><label for='data-ed66618d-0c3b-4dd0-ab98-8f447da9ff13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-ec32136c-3eb6-41b1-945c-1c4682a5b90c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec32136c-3eb6-41b1-945c-1c4682a5b90c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e910b538-6d05-4d2e-863b-d2937edea40c' class='xr-var-data-in' type='checkbox'><label for='data-e910b538-6d05-4d2e-863b-d2937edea40c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-fae71695-0e98-4a42-92d2-9be0af84f36b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fae71695-0e98-4a42-92d2-9be0af84f36b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-73e5bc88-3291-482d-b6c9-e17558c8a794' class='xr-var-data-in' type='checkbox'><label for='data-73e5bc88-3291-482d-b6c9-e17558c8a794' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-6ad0116a-1fee-41c3-90a7-3fb8343a15d2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6ad0116a-1fee-41c3-90a7-3fb8343a15d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a5ea5a6-38d6-45ed-acdd-6d8b5c398c15' class='xr-var-data-in' type='checkbox'><label for='data-8a5ea5a6-38d6-45ed-acdd-6d8b5c398c15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-477c93e6-78c8-4cb4-9f99-af79ce343cb7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-477c93e6-78c8-4cb4-9f99-af79ce343cb7' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, individuals, keypoints, space)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 384.0 588.6 476.3</div><input id='attrs-843e9a82-12f2-4e02-a44c-88a5be0947ff' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-843e9a82-12f2-4e02-a44c-88a5be0947ff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ca5ba5e-3321-49a0-b776-4cbc0e4a124c' class='xr-var-data-in' type='checkbox'><label for='data-3ca5ba5e-3321-49a0-b776-4cbc0e4a124c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;median_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:29.311440&#x27;, &#x27;arg_1&#x27;: 3, &#x27;min_periods&#x27;: 2}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
    ...
             [668.40027, 492.0457 ],
             [667.9094 , 437.27432],
             [636.7274 , 384.24048],
             [588.62775, 476.814  ]]],


           [[[688.1045 , 504.95605],
             [692.205  , 484.86316],
             [668.40027, 492.0457 ],
             [667.8683 , 439.9774 ],
             [636.824  , 384.10602],
             [588.56854, 476.33466]]],


           [[[688.18134, 507.72455],
             [692.3218 , 484.5658 ],
             [668.4878 , 492.0457 ],
             [667.9094 , 439.9774 ],
             [636.8362 , 384.02936],
             [588.56854, 476.33466]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, individuals, keypoints)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-caaeb50a-8a5f-47a6-acfe-ccecca821eed' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-caaeb50a-8a5f-47a6-acfe-ccecca821eed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27b4ea2e-47b0-4256-a846-86d6420579b0' class='xr-var-data-in' type='checkbox'><label for='data-27b4ea2e-47b0-4256-a846-86d6420579b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           ...,

           [[0.9317396 , 1.0026728 , 1.025079  , 0.92725545, 0.95202184,
             0.7779419 ]],

           [[0.9193515 , 1.0136327 , 1.0336665 , 0.93108493, 0.94561106,
             0.7662804 ]],

           [[0.93820494, 1.0224991 , 1.0452943 , 0.9363993 , 0.9335798 ,
             0.76068705]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f235ad9b-95d6-4dd2-bbd7-90b3d25880d3' class='xr-section-summary-in' type='checkbox'  ><label for='section-f235ad9b-95d6-4dd2-bbd7-90b3d25880d3' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ffb0b31d-dc1f-4626-9ed0-4f31c2574038' class='xr-index-data-in' type='checkbox'/><label for='index-ffb0b31d-dc1f-4626-9ed0-4f31c2574038' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d8f43a60-8017-47d5-8aa2-46f20f7e57d8' class='xr-index-data-in' type='checkbox'/><label for='index-d8f43a60-8017-47d5-8aa2-46f20f7e57d8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2326be81-19d6-45cb-9ca6-8afa66fbc783' class='xr-index-data-in' type='checkbox'/><label for='index-2326be81-19d6-45cb-9ca6-8afa66fbc783' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-aa11c8bf-abd9-49b5-9587-726294e4c6e9' class='xr-index-data-in' type='checkbox'/><label for='index-aa11c8bf-abd9-49b5-9587-726294e4c6e9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4a52d08d-8992-46ca-9a6a-f253797a9ea9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4a52d08d-8992-46ca-9a6a-f253797a9ea9' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd><dt><span>video_path :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 189-195

We see that this time the number of NaN values has decreased
across all keypoints.
Let's visualise the effects of the median filter in the time and frequency
domains. Here we focus on the first 80 seconds for the ``snout`` keypoint.
You can adjust the ``keypoint`` and ``time_range`` arguments to explore other
parts of the data.

.. GENERATED FROM PYTHON SOURCE LINES 195-200

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )




.. image-sg:: /examples/images/sphx_glr_smooth_002.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 201-205

The smoothing once again reduces the power of high-frequency components, but
the resulting time series stays quite close to the raw data.

What happens if we increase the ``window`` to 2 seconds (60 frames)?

.. GENERATED FROM PYTHON SOURCE LINES 205-211

.. code-block:: Python


    window = int(2 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {"position": median_filter(ds_mouse.position, window, min_periods=2)}
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 795/18485 (4.3%)
                    left_ear: 80/18485 (0.4%)
                    right_ear: 80/18485 (0.4%)
                    centre: 80/18485 (0.4%)
                    tail_base: 80/18485 (0.4%)
                    tail_end: 239/18485 (1.3%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, individuals: 1, keypoints: 6, space: 2)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
    Data variables:
        position     (time, individuals, keypoints, space) float32 887kB nan ... ...
        confidence   (time, individuals, keypoints) float32 444kB nan nan ... 0.7607
    Attributes:
        fps:              30.0
        time_unit:        seconds
        source_software:  SLEAP
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...
        video_path:       None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2f2753ee-9717-41cd-acc0-1fd4c8f6e0cb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2f2753ee-9717-41cd-acc0-1fd4c8f6e0cb' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>individuals</span>: 1</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>space</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b72bccfa-9bd4-440e-a3d9-854d0c320942' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b72bccfa-9bd4-440e-a3d9-854d0c320942' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-e3486fbf-339f-4bb0-9cd5-d3e07f6e60a6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e3486fbf-339f-4bb0-9cd5-d3e07f6e60a6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1f572e9-f845-48c4-b91e-092311338814' class='xr-var-data-in' type='checkbox'><label for='data-d1f572e9-f845-48c4-b91e-092311338814' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-5f40399a-b0c4-4a83-b838-3bf048ae512b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5f40399a-b0c4-4a83-b838-3bf048ae512b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cec15431-78f2-4049-a839-96c66c7c03e1' class='xr-var-data-in' type='checkbox'><label for='data-cec15431-78f2-4049-a839-96c66c7c03e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-76195790-0a01-4465-9f20-f6e2c710aada' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-76195790-0a01-4465-9f20-f6e2c710aada' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b38aeae-66e6-480f-bcd5-d4433c93d7a7' class='xr-var-data-in' type='checkbox'><label for='data-4b38aeae-66e6-480f-bcd5-d4433c93d7a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-143b3f8d-56f9-4bdc-a512-2d9bfd168d77' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-143b3f8d-56f9-4bdc-a512-2d9bfd168d77' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9322d48-536c-4235-8432-409f966150b5' class='xr-var-data-in' type='checkbox'><label for='data-a9322d48-536c-4235-8432-409f966150b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dc7f856a-6767-4428-ba34-158c6d2c3060' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dc7f856a-6767-4428-ba34-158c6d2c3060' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, individuals, keypoints, space)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 380.2 588.9 476.2</div><input id='attrs-9e95989d-5edc-422a-8e9e-cd4eb66f6bb2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9e95989d-5edc-422a-8e9e-cd4eb66f6bb2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4e73d74-95dd-4df2-bfd1-dc35f0e19cc4' class='xr-var-data-in' type='checkbox'><label for='data-f4e73d74-95dd-4df2-bfd1-dc35f0e19cc4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;median_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:29.548322&#x27;, &#x27;arg_1&#x27;: 60, &#x27;min_periods&#x27;: 2}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
    ...
             [667.99756, 479.82892],
             [668.1798 , 428.4925 ],
             [636.0231 , 380.2395 ],
             [588.89685, 476.2374 ]]],


           [[[684.6837 , 493.1562 ],
             [688.8197 , 476.5145 ],
             [667.8919 , 478.4414 ],
             [668.1798 , 428.46777],
             [635.98425, 380.2395 ],
             [588.90076, 476.2374 ]]],


           [[[684.67834, 493.02063],
             [688.80676, 476.48022],
             [667.78625, 477.0539 ],
             [668.1798 , 428.44302],
             [635.94543, 380.2395 ],
             [588.9046 , 476.2374 ]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, individuals, keypoints)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-c9e396a6-e9c7-488a-bee5-56f9a2e33de0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c9e396a6-e9c7-488a-bee5-56f9a2e33de0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-546023a3-30d7-4b34-8fbf-0d05c75203ef' class='xr-var-data-in' type='checkbox'><label for='data-546023a3-30d7-4b34-8fbf-0d05c75203ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           ...,

           [[0.9317396 , 1.0026728 , 1.025079  , 0.92725545, 0.95202184,
             0.7779419 ]],

           [[0.9193515 , 1.0136327 , 1.0336665 , 0.93108493, 0.94561106,
             0.7662804 ]],

           [[0.93820494, 1.0224991 , 1.0452943 , 0.9363993 , 0.9335798 ,
             0.76068705]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-da97df16-3240-47d3-8c1c-1170d3e70e5c' class='xr-section-summary-in' type='checkbox'  ><label for='section-da97df16-3240-47d3-8c1c-1170d3e70e5c' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-723ca06e-9544-4bd0-9ea9-ca879eb476b0' class='xr-index-data-in' type='checkbox'/><label for='index-723ca06e-9544-4bd0-9ea9-ca879eb476b0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-49f91676-6a26-443e-910a-1c5c5131fd20' class='xr-index-data-in' type='checkbox'/><label for='index-49f91676-6a26-443e-910a-1c5c5131fd20' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b288eefc-2a41-4536-9e20-b3ad1ba1113a' class='xr-index-data-in' type='checkbox'/><label for='index-b288eefc-2a41-4536-9e20-b3ad1ba1113a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-7921f81b-5fdd-4ae1-b3ea-cff2a810161d' class='xr-index-data-in' type='checkbox'/><label for='index-7921f81b-5fdd-4ae1-b3ea-cff2a810161d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-afa1a2db-1c95-4fcd-bd37-19a89a09b806' class='xr-section-summary-in' type='checkbox'  checked><label for='section-afa1a2db-1c95-4fcd-bd37-19a89a09b806' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd><dt><span>video_path :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 212-217

The number of NaN values has decreased even further.
That's because the chance of finding at least 2 valid values within
a 2-second window (i.e. 60 frames) is quite high.
Let's plot the results for the same keypoint and time range
as before.

.. GENERATED FROM PYTHON SOURCE LINES 217-221

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )



.. image-sg:: /examples/images/sphx_glr_smooth_003.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 222-230

We see that the filtered time series is much smoother and it has even
"bridged" over some small gaps. That said, it often deviates from the raw
data, in ways that may not be desirable, depending on the application.
Here, our choice of ``window`` may be too large.
In general, you should choose a ``window`` that is small enough to
preserve the original data structure, but large enough to remove
"spikes" and high-frequency noise. Always inspect the results to ensure
that the filter is not removing important features.

.. GENERATED FROM PYTHON SOURCE LINES 232-248

Smoothing with a Savitzky-Golay filter
--------------------------------------
Here we apply the :func:`movement.filtering.savgol_filter` function
(a wrapper around :func:`scipy.signal.savgol_filter`), to the ``position``
data variable.
The Savitzky-Golay filter is a polynomial smoothing filter that can be
applied to time series data on a rolling window basis.
A polynomial with a degree specified by ``polyorder`` is applied to each
data segment defined by the size ``window``.
The value of the polynomial at the midpoint of each ``window`` is then
used as the output value.

Let's try it on the mouse dataset, this time using a 0.2-second
window (i.e. 6 frames) and the default ``polyorder=2`` for smoothing.
As before, we first compute the corresponding number of observations
to be used as the ``window`` size.

.. GENERATED FROM PYTHON SOURCE LINES 248-252

.. code-block:: Python


    window = int(0.2 * ds_mouse.fps)
    ds_mouse_smooth.update({"position": savgol_filter(ds_mouse.position, window)})





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 5810/18485 (31.4%)
                    left_ear: 895/18485 (4.8%)
                    right_ear: 905/18485 (4.9%)
                    centre: 839/18485 (4.5%)
                    tail_base: 1186/18485 (6.4%)
                    tail_end: 3801/18485 (20.6%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, individuals: 1, keypoints: 6, space: 2)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
    Data variables:
        position     (time, individuals, keypoints, space) float32 887kB nan ... ...
        confidence   (time, individuals, keypoints) float32 444kB nan nan ... 0.7607
    Attributes:
        fps:              30.0
        time_unit:        seconds
        source_software:  SLEAP
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...
        video_path:       None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-3eeb4388-57b1-4e3e-ae7f-a6cbcde2bb5c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3eeb4388-57b1-4e3e-ae7f-a6cbcde2bb5c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>individuals</span>: 1</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>space</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e486ba4c-475f-406c-91b8-aa86a929c6a0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e486ba4c-475f-406c-91b8-aa86a929c6a0' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-b903bee1-fc17-4c3e-ad9e-8f9d9fa68c67' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b903bee1-fc17-4c3e-ad9e-8f9d9fa68c67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-718df5bf-3bd8-4f57-88b7-5fecba06278a' class='xr-var-data-in' type='checkbox'><label for='data-718df5bf-3bd8-4f57-88b7-5fecba06278a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-c95c4af0-ea85-4e6c-a83c-0d24ef9762a6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c95c4af0-ea85-4e6c-a83c-0d24ef9762a6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74b8a5e3-0ff1-41b4-9645-7f93b5cae5fc' class='xr-var-data-in' type='checkbox'><label for='data-74b8a5e3-0ff1-41b4-9645-7f93b5cae5fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-a607f9b5-54f3-4e2e-a53d-3ebc8fdecbec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a607f9b5-54f3-4e2e-a53d-3ebc8fdecbec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-caa9a5ef-5311-4be9-bd72-a71c4865fbda' class='xr-var-data-in' type='checkbox'><label for='data-caa9a5ef-5311-4be9-bd72-a71c4865fbda' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-a0b6edf2-c3c2-4ccf-b55e-9418bd1e0632' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a0b6edf2-c3c2-4ccf-b55e-9418bd1e0632' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5cc68bb5-3f94-4e23-829f-241cd41e7ac0' class='xr-var-data-in' type='checkbox'><label for='data-5cc68bb5-3f94-4e23-829f-241cd41e7ac0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ac71e6bb-8e9a-4157-a685-8586323e0287' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ac71e6bb-8e9a-4157-a685-8586323e0287' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, individuals, keypoints, space)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 384.0 588.4 476.2</div><input id='attrs-27607137-1fdf-4cb7-8a9e-e9d89ca0ee70' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27607137-1fdf-4cb7-8a9e-e9d89ca0ee70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-18848f84-2fc3-4b0c-a1e7-1b024f12c077' class='xr-var-data-in' type='checkbox'><label for='data-18848f84-2fc3-4b0c-a1e7-1b024f12c077' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;savgol_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:29.771833&#x27;, &#x27;arg_1&#x27;: 6}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
    ...
             [668.297  , 491.02277],
             [667.9091 , 437.9163 ],
             [636.7103 , 384.20148],
             [588.6233 , 476.71515]]],


           [[[686.60693, 506.11816],
             [691.53265, 486.02914],
             [668.32794, 491.82062],
             [667.8682 , 439.01932],
             [636.7771 , 384.39636],
             [588.5212 , 476.5229 ]]],


           [[[685.86224, 505.34033],
             [693.0002 , 486.7021 ],
             [668.3964 , 492.4088 ],
             [667.8464 , 440.36227],
             [636.8503 , 384.02908],
             [588.4095 , 476.17532]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, individuals, keypoints)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-8acb3b41-d7fc-4a05-8286-68a3bbbcc6ac' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8acb3b41-d7fc-4a05-8286-68a3bbbcc6ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eba50b43-9211-47ac-87a1-75eaf3143f98' class='xr-var-data-in' type='checkbox'><label for='data-eba50b43-9211-47ac-87a1-75eaf3143f98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           ...,

           [[0.9317396 , 1.0026728 , 1.025079  , 0.92725545, 0.95202184,
             0.7779419 ]],

           [[0.9193515 , 1.0136327 , 1.0336665 , 0.93108493, 0.94561106,
             0.7662804 ]],

           [[0.93820494, 1.0224991 , 1.0452943 , 0.9363993 , 0.9335798 ,
             0.76068705]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-922982cd-3476-4b62-b2d1-55cbf5ab2821' class='xr-section-summary-in' type='checkbox'  ><label for='section-922982cd-3476-4b62-b2d1-55cbf5ab2821' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-9059fd5d-08b5-4b88-b6db-f4131c0ab89d' class='xr-index-data-in' type='checkbox'/><label for='index-9059fd5d-08b5-4b88-b6db-f4131c0ab89d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-537dd2d7-0c5b-4463-b546-51b25f99a4e8' class='xr-index-data-in' type='checkbox'/><label for='index-537dd2d7-0c5b-4463-b546-51b25f99a4e8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8b556267-3a46-4e3b-90ab-bb1ddc18a170' class='xr-index-data-in' type='checkbox'/><label for='index-8b556267-3a46-4e3b-90ab-bb1ddc18a170' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-71f02231-d016-4041-88e1-27ed89537a04' class='xr-index-data-in' type='checkbox'/><label for='index-71f02231-d016-4041-88e1-27ed89537a04' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0fb095f3-5cc0-4d99-bbb4-690d3da2d6f7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0fb095f3-5cc0-4d99-bbb4-690d3da2d6f7' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd><dt><span>video_path :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 253-259

We see that the number of NaN values has increased after filtering. This is
for the same reason as with the median filter (in its default mode), i.e.
if there is at least one NaN value in the window, the output will be NaN.
Unlike the median filter, the Savitzky-Golay filter does not provide a
``min_periods`` parameter to control this behaviour. Let's visualise the
effects in the time and frequency domains.

.. GENERATED FROM PYTHON SOURCE LINES 259-263

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse, ds_mouse_smooth, keypoint="snout", time_range=slice(0, 80)
    )



.. image-sg:: /examples/images/sphx_glr_smooth_004.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 264-266

Once again, the power of high-frequency components has been reduced, but more
missing values have been introduced.

.. GENERATED FROM PYTHON SOURCE LINES 268-269

Now let's apply the same Savitzky-Golay filter to the wasp dataset.

.. GENERATED FROM PYTHON SOURCE LINES 269-273

.. code-block:: Python


    window = int(0.2 * ds_wasp.fps)
    ds_wasp_smooth.update({"position": savgol_filter(ds_wasp.position, window)})





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    head: 0/1085 (0.0%)
                    stinger: 0/1085 (0.0%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 61kB
    Dimensions:      (time: 1085, individuals: 1, keypoints: 2, space: 2)
    Coordinates:
      * time         (time) float64 9kB 0.0 0.025 0.05 0.075 ... 27.05 27.07 27.1
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
      * keypoints    (keypoints) &lt;U7 56B &#x27;head&#x27; &#x27;stinger&#x27;
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
    Data variables:
        position     (time, individuals, keypoints, space) float64 35kB 1.086e+03...
        confidence   (time, individuals, keypoints) float64 17kB 0.05305 ... 0.0
    Attributes:
        fps:              40.0
        time_unit:        seconds
        source_software:  DeepLabCut
        source_file:      /home/runner/.movement/data/poses/DLC_single-wasp.predi...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-wasp_frame-10...
        video_path:       None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2b8f0e06-e6e8-4bf7-af2d-2b8d5e757aa9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2b8f0e06-e6e8-4bf7-af2d-2b8d5e757aa9' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1085</li><li><span class='xr-has-index'>individuals</span>: 1</li><li><span class='xr-has-index'>keypoints</span>: 2</li><li><span class='xr-has-index'>space</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-38105396-d8ad-488f-86cc-91c5bd660ff8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-38105396-d8ad-488f-86cc-91c5bd660ff8' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.025 0.05 ... 27.05 27.07 27.1</div><input id='attrs-d2f6a2f1-b643-4e2e-911c-8f571bb5289f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d2f6a2f1-b643-4e2e-911c-8f571bb5289f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ff55583-864f-4d6b-ac57-4d24896c781c' class='xr-var-data-in' type='checkbox'><label for='data-9ff55583-864f-4d6b-ac57-4d24896c781c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.0000e+00, 2.5000e-02, 5.0000e-02, ..., 2.7050e+01, 2.7075e+01,
           2.7100e+01])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-011c24fc-8445-4b6c-b0e4-97da446dc0cf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-011c24fc-8445-4b6c-b0e4-97da446dc0cf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36d9fbb8-df91-4f81-8d0b-f4813e6ed06a' class='xr-var-data-in' type='checkbox'><label for='data-36d9fbb8-df91-4f81-8d0b-f4813e6ed06a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;head&#x27; &#x27;stinger&#x27;</div><input id='attrs-7e3142dd-5b75-41a9-9454-f3d3b81a7b0e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e3142dd-5b75-41a9-9454-f3d3b81a7b0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3407bce4-5834-4e14-b53f-4f3ddc2462cb' class='xr-var-data-in' type='checkbox'><label for='data-3407bce4-5834-4e14-b53f-4f3ddc2462cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-3dd2be64-e027-416e-85e1-877ded8b87d0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3dd2be64-e027-416e-85e1-877ded8b87d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6cb1eec-a6b7-43f6-8917-f40b4f6e618d' class='xr-var-data-in' type='checkbox'><label for='data-d6cb1eec-a6b7-43f6-8917-f40b4f6e618d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a550b987-7a10-4af9-904e-6eaefea4ecc1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a550b987-7a10-4af9-904e-6eaefea4ecc1' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, individuals, keypoints, space)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.086e+03 421.5 ... 0.0 0.0</div><input id='attrs-1e8acaf1-4912-4aa1-b4c5-de9064b2b0bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e8acaf1-4912-4aa1-b4c5-de9064b2b0bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-baacaf76-259b-41c3-becb-2c80c3fb5286' class='xr-var-data-in' type='checkbox'><label for='data-baacaf76-259b-41c3-becb-2c80c3fb5286' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;savgol_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:29.984832&#x27;, &#x27;arg_1&#x27;: 8}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[1086.21587626,  421.48088328],
             [1084.39068604,  420.21653112]]],


           [[[1085.91406323,  421.67755381],
             [1083.25480725,  422.10508746]]],


           [[[1085.62648446,  421.90293339],
             [1082.09089007,  423.7017152 ]]],


           ...,


           [[[   0.        ,    0.        ],
             [   0.        ,    0.        ]]],


           [[[   0.        ,    0.        ],
             [   0.        ,    0.        ]]],


           [[[   0.        ,    0.        ],
             [   0.        ,    0.        ]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, individuals, keypoints)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.05305 0.07366 0.03532 ... 0.0 0.0</div><input id='attrs-99da7ce3-a1bd-4be9-88fc-95c18c31913e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-99da7ce3-a1bd-4be9-88fc-95c18c31913e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1037d07-29bc-4110-9bca-a6ae1f572ce1' class='xr-var-data-in' type='checkbox'><label for='data-a1037d07-29bc-4110-9bca-a6ae1f572ce1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.05305099, 0.07366323]],

           [[0.03531652, 0.03293059]],

           [[0.01706707, 0.01022208]],

           ...,

           [[0.        , 0.        ]],

           [[0.        , 0.        ]],

           [[0.        , 0.        ]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-278ae382-ec52-4af1-a199-d0ff460358cc' class='xr-section-summary-in' type='checkbox'  ><label for='section-278ae382-ec52-4af1-a199-d0ff460358cc' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-861477a4-545b-48e1-b75a-9a5d0a0394dc' class='xr-index-data-in' type='checkbox'/><label for='index-861477a4-545b-48e1-b75a-9a5d0a0394dc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0.0,  0.025,   0.05,  0.075,    0.1,  0.125,   0.15,  0.175,    0.2,
            0.225,
           ...
           26.875,   26.9, 26.925,  26.95, 26.975,   27.0, 27.025,  27.05, 27.075,
             27.1],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=1085))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b15fbdf8-38ca-4827-b815-c7985e67d741' class='xr-index-data-in' type='checkbox'/><label for='index-b15fbdf8-38ca-4827-b815-c7985e67d741' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-2a16f1a9-64ed-4d15-9c7c-163bcae7b0b7' class='xr-index-data-in' type='checkbox'/><label for='index-2a16f1a9-64ed-4d15-9c7c-163bcae7b0b7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;head&#x27;, &#x27;stinger&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f289c4dd-2138-44b4-b9e0-444bc65130c7' class='xr-index-data-in' type='checkbox'/><label for='index-f289c4dd-2138-44b4-b9e0-444bc65130c7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ac794495-7d7a-4f78-b015-e25f25321121' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ac794495-7d7a-4f78-b015-e25f25321121' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fps :</span></dt><dd>40.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_software :</span></dt><dd>DeepLabCut</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/DLC_single-wasp.predictions.h5</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-wasp_frame-10sec.png</dd><dt><span>video_path :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 274-277

.. code-block:: Python

    plot_raw_and_smooth_timeseries_and_psd(
        ds_wasp, ds_wasp_smooth, keypoint="stinger"
    )



.. image-sg:: /examples/images/sphx_glr_smooth_005.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 278-286

This example shows two important limitations of the Savitzky-Golay filter.
First, the filter can introduce artefacts around sharp boundaries. For
example, focus on what happens around the sudden drop in position
during the final second. Second, the PSD appears to have large periodic
drops at certain frequencies. Both of these effects vary with the
choice of ``window`` and ``polyorder``. You can read more about these
and other limitations of the Savitzky-Golay filter in
`this paper <https://pubs.acs.org/doi/10.1021/acsmeasuresciau.1c00054>`_.

.. GENERATED FROM PYTHON SOURCE LINES 289-297

Combining multiple smoothing filters
------------------------------------
We can also combine multiple smoothing filters by applying them
sequentially. For example, we can first apply the median filter with a small
``window`` to remove "spikes" and then apply the Savitzky-Golay filter
with a larger ``window`` to further smooth the data.
Between the two filters, we can interpolate over small gaps to avoid the
excessive proliferation of NaN values. Let's try this on the mouse dataset.

.. GENERATED FROM PYTHON SOURCE LINES 297-317

.. code-block:: Python


    # First, we will apply the median filter.
    window = int(0.1 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {"position": median_filter(ds_mouse.position, window, min_periods=2)}
    )

    # Next, let's linearly interpolate over gaps smaller
    # than 1 second (30 frames).
    ds_mouse_smooth.update(
        {"position": interpolate_over_time(ds_mouse_smooth.position, max_gap=30)}
    )

    # Finally, let's apply the Savitzky-Golay filter
    # over a 0.4-second window (12 frames).
    window = int(0.4 * ds_mouse.fps)
    ds_mouse_smooth.update(
        {"position": savgol_filter(ds_mouse_smooth.position, window)}
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4494/18485 (24.3%)
                    left_ear: 513/18485 (2.8%)
                    right_ear: 533/18485 (2.9%)
                    centre: 490/18485 (2.7%)
                    tail_base: 704/18485 (3.8%)
                    tail_end: 2496/18485 (13.5%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 4455/18485 (24.1%)
                    left_ear: 487/18485 (2.6%)
                    right_ear: 507/18485 (2.7%)
                    centre: 465/18485 (2.5%)
                    tail_base: 673/18485 (3.6%)
                    tail_end: 2428/18485 (13.1%)

    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 4455/18485 (24.1%)
                    left_ear: 487/18485 (2.6%)
                    right_ear: 507/18485 (2.7%)
                    centre: 465/18485 (2.5%)
                    tail_base: 673/18485 (3.6%)
                    tail_end: 2428/18485 (13.1%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 3011/18485 (16.3%)
                    left_ear: 257/18485 (1.4%)
                    right_ear: 294/18485 (1.6%)
                    centre: 257/18485 (1.4%)
                    tail_base: 257/18485 (1.4%)
                    tail_end: 1101/18485 (6.0%)

    Missing points (marked as NaN) in input
            Individual: individual_0
                    snout: 3011/18485 (16.3%)
                    left_ear: 257/18485 (1.4%)
                    right_ear: 294/18485 (1.6%)
                    centre: 257/18485 (1.4%)
                    tail_base: 257/18485 (1.4%)
                    tail_end: 1101/18485 (6.0%)

    Missing points (marked as NaN) in output
            Individual: individual_0
                    snout: 3520/18485 (19.0%)
                    left_ear: 306/18485 (1.7%)
                    right_ear: 354/18485 (1.9%)
                    centre: 306/18485 (1.7%)
                    tail_base: 306/18485 (1.7%)
                    tail_end: 1304/18485 (7.1%)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
    <defs>
    <symbol id="icon-database" viewBox="0 0 32 32">
    <path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
    <path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    <path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
    </symbol>
    <symbol id="icon-file-text2" viewBox="0 0 32 32">
    <path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
    <path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    <path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
    </symbol>
    </defs>
    </svg>
    <style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
     *
     */

    :root {
      --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
      --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
      --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
      --xr-border-color: var(--jp-border-color2, #e0e0e0);
      --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
      --xr-background-color: var(--jp-layout-color0, white);
      --xr-background-color-row-even: var(--jp-layout-color1, white);
      --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
    }

    html[theme="dark"],
    html[data-theme="dark"],
    body[data-theme="dark"],
    body.vscode-dark {
      --xr-font-color0: rgba(255, 255, 255, 1);
      --xr-font-color2: rgba(255, 255, 255, 0.54);
      --xr-font-color3: rgba(255, 255, 255, 0.38);
      --xr-border-color: #1f1f1f;
      --xr-disabled-color: #515151;
      --xr-background-color: #111111;
      --xr-background-color-row-even: #111111;
      --xr-background-color-row-odd: #313131;
    }

    .xr-wrap {
      display: block !important;
      min-width: 300px;
      max-width: 700px;
    }

    .xr-text-repr-fallback {
      /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
      display: none;
    }

    .xr-header {
      padding-top: 6px;
      padding-bottom: 6px;
      margin-bottom: 4px;
      border-bottom: solid 1px var(--xr-border-color);
    }

    .xr-header > div,
    .xr-header > ul {
      display: inline;
      margin-top: 0;
      margin-bottom: 0;
    }

    .xr-obj-type,
    .xr-array-name {
      margin-left: 2px;
      margin-right: 10px;
    }

    .xr-obj-type {
      color: var(--xr-font-color2);
    }

    .xr-sections {
      padding-left: 0 !important;
      display: grid;
      grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
    }

    .xr-section-item {
      display: contents;
    }

    .xr-section-item input {
      display: inline-block;
      opacity: 0;
      height: 0;
    }

    .xr-section-item input + label {
      color: var(--xr-disabled-color);
    }

    .xr-section-item input:enabled + label {
      cursor: pointer;
      color: var(--xr-font-color2);
    }

    .xr-section-item input:focus + label {
      border: 2px solid var(--xr-font-color0);
    }

    .xr-section-item input:enabled + label:hover {
      color: var(--xr-font-color0);
    }

    .xr-section-summary {
      grid-column: 1;
      color: var(--xr-font-color2);
      font-weight: 500;
    }

    .xr-section-summary > span {
      display: inline-block;
      padding-left: 0.5em;
    }

    .xr-section-summary-in:disabled + label {
      color: var(--xr-font-color2);
    }

    .xr-section-summary-in + label:before {
      display: inline-block;
      content: "►";
      font-size: 11px;
      width: 15px;
      text-align: center;
    }

    .xr-section-summary-in:disabled + label:before {
      color: var(--xr-disabled-color);
    }

    .xr-section-summary-in:checked + label:before {
      content: "▼";
    }

    .xr-section-summary-in:checked + label > span {
      display: none;
    }

    .xr-section-summary,
    .xr-section-inline-details {
      padding-top: 4px;
      padding-bottom: 4px;
    }

    .xr-section-inline-details {
      grid-column: 2 / -1;
    }

    .xr-section-details {
      display: none;
      grid-column: 1 / -1;
      margin-bottom: 5px;
    }

    .xr-section-summary-in:checked ~ .xr-section-details {
      display: contents;
    }

    .xr-array-wrap {
      grid-column: 1 / -1;
      display: grid;
      grid-template-columns: 20px auto;
    }

    .xr-array-wrap > label {
      grid-column: 1;
      vertical-align: top;
    }

    .xr-preview {
      color: var(--xr-font-color3);
    }

    .xr-array-preview,
    .xr-array-data {
      padding: 0 5px !important;
      grid-column: 2;
    }

    .xr-array-data,
    .xr-array-in:checked ~ .xr-array-preview {
      display: none;
    }

    .xr-array-in:checked ~ .xr-array-data,
    .xr-array-preview {
      display: inline-block;
    }

    .xr-dim-list {
      display: inline-block !important;
      list-style: none;
      padding: 0 !important;
      margin: 0;
    }

    .xr-dim-list li {
      display: inline-block;
      padding: 0;
      margin: 0;
    }

    .xr-dim-list:before {
      content: "(";
    }

    .xr-dim-list:after {
      content: ")";
    }

    .xr-dim-list li:not(:last-child):after {
      content: ",";
      padding-right: 5px;
    }

    .xr-has-index {
      font-weight: bold;
    }

    .xr-var-list,
    .xr-var-item {
      display: contents;
    }

    .xr-var-item > div,
    .xr-var-item label,
    .xr-var-item > .xr-var-name span {
      background-color: var(--xr-background-color-row-even);
      margin-bottom: 0;
    }

    .xr-var-item > .xr-var-name:hover span {
      padding-right: 5px;
    }

    .xr-var-list > li:nth-child(odd) > div,
    .xr-var-list > li:nth-child(odd) > label,
    .xr-var-list > li:nth-child(odd) > .xr-var-name span {
      background-color: var(--xr-background-color-row-odd);
    }

    .xr-var-name {
      grid-column: 1;
    }

    .xr-var-dims {
      grid-column: 2;
    }

    .xr-var-dtype {
      grid-column: 3;
      text-align: right;
      color: var(--xr-font-color2);
    }

    .xr-var-preview {
      grid-column: 4;
    }

    .xr-index-preview {
      grid-column: 2 / 5;
      color: var(--xr-font-color2);
    }

    .xr-var-name,
    .xr-var-dims,
    .xr-var-dtype,
    .xr-preview,
    .xr-attrs dt {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 10px;
    }

    .xr-var-name:hover,
    .xr-var-dims:hover,
    .xr-var-dtype:hover,
    .xr-attrs dt:hover {
      overflow: visible;
      width: auto;
      z-index: 1;
    }

    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      display: none;
      background-color: var(--xr-background-color) !important;
      padding-bottom: 5px !important;
    }

    .xr-var-attrs-in:checked ~ .xr-var-attrs,
    .xr-var-data-in:checked ~ .xr-var-data,
    .xr-index-data-in:checked ~ .xr-index-data {
      display: block;
    }

    .xr-var-data > table {
      float: right;
    }

    .xr-var-name span,
    .xr-var-data,
    .xr-index-name div,
    .xr-index-data,
    .xr-attrs {
      padding-left: 25px !important;
    }

    .xr-attrs,
    .xr-var-attrs,
    .xr-var-data,
    .xr-index-data {
      grid-column: 1 / -1;
    }

    dl.xr-attrs {
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 125px auto;
    }

    .xr-attrs dt,
    .xr-attrs dd {
      padding: 0;
      margin: 0;
      float: left;
      padding-right: 10px;
      width: auto;
    }

    .xr-attrs dt {
      font-weight: normal;
      grid-column: 1;
    }

    .xr-attrs dt:hover span {
      display: inline-block;
      background: var(--xr-background-color);
      padding-right: 10px;
    }

    .xr-attrs dd {
      grid-column: 2;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .xr-icon-database,
    .xr-icon-file-text2,
    .xr-no-icon {
      display: inline-block;
      vertical-align: middle;
      width: 1em;
      height: 1.5em !important;
      stroke-width: 0;
      stroke: currentColor;
      fill: currentColor;
    }
    </style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1MB
    Dimensions:      (time: 18485, individuals: 1, keypoints: 6, space: 2)
    Coordinates:
      * time         (time) float64 148kB 0.0 0.03333 0.06667 ... 616.1 616.1 616.1
      * individuals  (individuals) &lt;U12 48B &#x27;individual_0&#x27;
      * keypoints    (keypoints) &lt;U9 216B &#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;
      * space        (space) &lt;U1 8B &#x27;x&#x27; &#x27;y&#x27;
    Data variables:
        position     (time, individuals, keypoints, space) float32 887kB nan ... ...
        confidence   (time, individuals, keypoints) float32 444kB nan nan ... 0.7607
    Attributes:
        fps:              30.0
        time_unit:        seconds
        source_software:  SLEAP
        source_file:      /home/runner/.movement/data/poses/SLEAP_single-mouse_EP...
        ds_type:          poses
        frame_path:       /home/runner/.movement/data/frames/single-mouse_EPM_fra...
        video_path:       None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-95650c2a-d6d3-4fac-9a7f-feeaa8b64920' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-95650c2a-d6d3-4fac-9a7f-feeaa8b64920' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 18485</li><li><span class='xr-has-index'>individuals</span>: 1</li><li><span class='xr-has-index'>keypoints</span>: 6</li><li><span class='xr-has-index'>space</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5c2755cd-6f10-40aa-8d02-e908ea857b6d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5c2755cd-6f10-40aa-8d02-e908ea857b6d' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.03333 0.06667 ... 616.1 616.1</div><input id='attrs-9aa60581-9033-4359-862f-88487b28db42' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9aa60581-9033-4359-862f-88487b28db42' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef382dc8-6195-47d3-8063-6956d0c0529c' class='xr-var-data-in' type='checkbox'><label for='data-ef382dc8-6195-47d3-8063-6956d0c0529c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 3.333333e-02, 6.666667e-02, ..., 6.160667e+02,
           6.161000e+02, 6.161333e+02])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>individuals</span></div><div class='xr-var-dims'>(individuals)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;individual_0&#x27;</div><input id='attrs-08b392f9-6183-400d-9533-5c1b9250a448' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-08b392f9-6183-400d-9533-5c1b9250a448' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf59cc86-791b-4a6f-ad0e-521b0e658bb4' class='xr-var-data-in' type='checkbox'><label for='data-bf59cc86-791b-4a6f-ad0e-521b0e658bb4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;individual_0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>keypoints</span></div><div class='xr-var-dims'>(keypoints)</div><div class='xr-var-dtype'>&lt;U9</div><div class='xr-var-preview xr-preview'>&#x27;snout&#x27; &#x27;left_ear&#x27; ... &#x27;tail_end&#x27;</div><input id='attrs-c089c6d9-20c3-4d02-a033-7fa29446c851' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c089c6d9-20c3-4d02-a033-7fa29446c851' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2deb4938-47b1-49bc-b0a4-4084ea5946f7' class='xr-var-data-in' type='checkbox'><label for='data-2deb4938-47b1-49bc-b0a4-4084ea5946f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;],
          dtype=&#x27;&lt;U9&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>space</span></div><div class='xr-var-dims'>(space)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27;</div><input id='attrs-3636c1f2-e2a7-41f5-90c6-898b59e614e7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3636c1f2-e2a7-41f5-90c6-898b59e614e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d248e10b-59f9-48b3-8654-0a416cdf9830' class='xr-var-data-in' type='checkbox'><label for='data-d248e10b-59f9-48b3-8654-0a416cdf9830' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-12c1185f-412a-4a54-8d7d-91b4f7772923' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12c1185f-412a-4a54-8d7d-91b4f7772923' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>position</span></div><div class='xr-var-dims'>(time, individuals, keypoints, space)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 384.9 588.5 476.4</div><input id='attrs-82783d42-1601-4321-b622-c1d27a148c7e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-82783d42-1601-4321-b622-c1d27a148c7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c93dc64d-b4b2-48b7-83cf-6f8411e3ba5a' class='xr-var-data-in' type='checkbox'><label for='data-c93dc64d-b4b2-48b7-83cf-6f8411e3ba5a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>log :</span></dt><dd>[{&#x27;operation&#x27;: &#x27;median_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:30.212124&#x27;, &#x27;arg_1&#x27;: 3, &#x27;min_periods&#x27;: 2}, {&#x27;operation&#x27;: &#x27;interpolate_over_time&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:30.248955&#x27;, &#x27;max_gap&#x27;: 30}, {&#x27;operation&#x27;: &#x27;savgol_filter&#x27;, &#x27;datetime&#x27;: &#x27;2024-12-02 15:49:30.264986&#x27;, &#x27;arg_1&#x27;: 12}]</dd></dl></div><div class='xr-var-data'><pre>array([[[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan]]],


           [[[      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
             [      nan,       nan],
    ...
             [668.83014, 490.7965 ],
             [667.9423 , 438.33127],
             [636.7261 , 383.2832 ],
             [588.684  , 476.54413]]],


           [[[687.3569 , 506.20914],
             [691.73596, 484.99295],
             [668.33374, 491.70206],
             [667.912  , 439.1004 ],
             [636.7917 , 384.04898],
             [588.59326, 476.4877 ]]],


           [[[687.1241 , 507.36728],
             [691.6779 , 485.9541 ],
             [667.5868 , 492.4988 ],
             [667.8876 , 439.8272 ],
             [636.8564 , 384.89087],
             [588.4856 , 476.4103 ]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>confidence</span></div><div class='xr-var-dims'>(time, individuals, keypoints)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan ... 0.9336 0.7607</div><input id='attrs-3531ad40-04ef-40fe-96b5-e579b9a1e09b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3531ad40-04ef-40fe-96b5-e579b9a1e09b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e28342af-2742-40e0-8b2a-18948cb4038e' class='xr-var-data-in' type='checkbox'><label for='data-e28342af-2742-40e0-8b2a-18948cb4038e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           [[       nan,        nan,        nan,        nan,        nan,
                    nan]],

           ...,

           [[0.9317396 , 1.0026728 , 1.025079  , 0.92725545, 0.95202184,
             0.7779419 ]],

           [[0.9193515 , 1.0136327 , 1.0336665 , 0.93108493, 0.94561106,
             0.7662804 ]],

           [[0.93820494, 1.0224991 , 1.0452943 , 0.9363993 , 0.9335798 ,
             0.76068705]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-52ec0b4b-e99f-47ca-9cac-2e54a6a28133' class='xr-section-summary-in' type='checkbox'  ><label for='section-52ec0b4b-e99f-47ca-9cac-2e54a6a28133' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ca58dbfc-d4eb-447b-b030-32595813a14b' class='xr-index-data-in' type='checkbox'/><label for='index-ca58dbfc-d4eb-447b-b030-32595813a14b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                0.0, 0.03333333333333333, 0.06666666666666667,
                           0.1, 0.13333333333333333, 0.16666666666666666,
                           0.2, 0.23333333333333334, 0.26666666666666666,
                           0.3,
           ...
             615.8333333333334,   615.8666666666667,               615.9,
             615.9333333333333,   615.9666666666667,               616.0,
             616.0333333333333,   616.0666666666667,               616.1,
             616.1333333333333],
          dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=18485))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>individuals</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-834ef8fc-ca9b-41f2-b75f-12aa69519781' class='xr-index-data-in' type='checkbox'/><label for='index-834ef8fc-ca9b-41f2-b75f-12aa69519781' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;individual_0&#x27;], dtype=&#x27;object&#x27;, name=&#x27;individuals&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>keypoints</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4349f5a1-d993-493f-9f41-e794bc11aacd' class='xr-index-data-in' type='checkbox'/><label for='index-4349f5a1-d993-493f-9f41-e794bc11aacd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;snout&#x27;, &#x27;left_ear&#x27;, &#x27;right_ear&#x27;, &#x27;centre&#x27;, &#x27;tail_base&#x27;, &#x27;tail_end&#x27;], dtype=&#x27;object&#x27;, name=&#x27;keypoints&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>space</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-3f5d765f-b9a6-4111-a2ed-e3814cf700ef' class='xr-index-data-in' type='checkbox'/><label for='index-3f5d765f-b9a6-4111-a2ed-e3814cf700ef' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;x&#x27;, &#x27;y&#x27;], dtype=&#x27;object&#x27;, name=&#x27;space&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5dc784a6-3356-4c6d-8975-6f895da73d1b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5dc784a6-3356-4c6d-8975-6f895da73d1b' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fps :</span></dt><dd>30.0</dd><dt><span>time_unit :</span></dt><dd>seconds</dd><dt><span>source_software :</span></dt><dd>SLEAP</dd><dt><span>source_file :</span></dt><dd>/home/runner/.movement/data/poses/SLEAP_single-mouse_EPM.analysis.h5</dd><dt><span>ds_type :</span></dt><dd>poses</dd><dt><span>frame_path :</span></dt><dd>/home/runner/.movement/data/frames/single-mouse_EPM_frame-20sec.png</dd><dt><span>video_path :</span></dt><dd>None</dd></dl></div></li></ul></div></div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 318-321

A record of all applied operations is stored in the ``log`` attribute of the
``ds_mouse_smooth.position`` data array. Let's inspect it to summarise
what we've done.

.. GENERATED FROM PYTHON SOURCE LINES 321-325

.. code-block:: Python


    for entry in ds_mouse_smooth.position.log:
        print(entry)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    {'operation': 'median_filter', 'datetime': '2024-12-02 15:49:30.212124', 'arg_1': 3, 'min_periods': 2}
    {'operation': 'interpolate_over_time', 'datetime': '2024-12-02 15:49:30.248955', 'max_gap': 30}
    {'operation': 'savgol_filter', 'datetime': '2024-12-02 15:49:30.264986', 'arg_1': 12}




.. GENERATED FROM PYTHON SOURCE LINES 326-328

Now let's visualise the difference between the raw data and the final
smoothed result.

.. GENERATED FROM PYTHON SOURCE LINES 328-336

.. code-block:: Python


    plot_raw_and_smooth_timeseries_and_psd(
        ds_mouse,
        ds_mouse_smooth,
        keypoint="snout",
        time_range=slice(0, 80),
    )




.. image-sg:: /examples/images/sphx_glr_smooth_006.png
   :alt: Time Domain, Frequency Domain
   :srcset: /examples/images/sphx_glr_smooth_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 337-339

Feel free to play around with the parameters of the applied filters and to
also look at other keypoints and time ranges.

.. GENERATED FROM PYTHON SOURCE LINES 341-345

.. seealso::
  :ref:`examples/filter_and_interpolate:Filtering multiple data variables`
  in the
  :ref:`sphx_glr_examples_filter_and_interpolate.py` example.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.490 seconds)


.. _sphx_glr_download_examples_smooth.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/neuroinformatics-unit/movement/gh-pages?filepath=notebooks/examples/smooth.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: smooth.ipynb <smooth.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: smooth.py <smooth.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: smooth.zip <smooth.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
